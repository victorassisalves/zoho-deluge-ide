<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Zoho Deluge Advanced IDE v1.2.3</title>
    <link rel="stylesheet" href="ide.css">

    <link rel="stylesheet" data-name="vs/editor/editor.main" href="assets/monaco-editor/min/vs/editor/editor.main.css">
</head>
<body>
    <div id="app-container">
        <header id="top-bar">
            <div class="logo">Deluge IDE <div class="project-info" style="margin-left: 20px; display: inline-flex; align-items: center; gap: 5px;"><label style="font-size: 10px; color: #888;">Project:</label><input type="text" id="project-name-input" placeholder="Untitled Project" style="background: #1e1e1e; color: #ccc; border: 1px solid #444; padding: 2px 5px; font-size: 11px; width: 150px;"></div></div>
            <div class="actions">
                <span id="status-indicator">Disconnected</span>
                <button id="new-btn" title="New Script">New</button>
                <button id="pull-btn" title="Pull (Ctrl+Shift+P)">Pull</button>
                <button id="push-btn" title="Sync (Ctrl+Shift+S)">Sync</button>
                <button id="interface-btn" title="JSON to Deluge Map">JSON->Map</button>
                <button id="execute-btn" style="background:#28a745;" title="Sync + Execute (Ctrl+Shift+Enter)">Run</button>
                    <button id="save-btn" title="Save Locally (Ctrl+S)">Save</button>
            </div>
        </header>
        <main id="main-content">
            <aside id="sidebar">
                <div class="sidebar-item active" data-view="explorer" title="Explorer">üìÅ</div>
                <div class="sidebar-item" data-view="cloud" title="Workspaces">‚òÅÔ∏è</div>
                <div class="sidebar-item" data-view="ai-agent" title="AI Agent">ü§ñ</div>
                <div class="sidebar-item" data-view="zoho-apis" title="Zoho APIs">üìñ</div>
                <div class="sidebar-item" data-view="snippets" title="Snippets">üìã</div>
                <div class="sidebar-item" data-view="extensions" title="Extensions">üß©</div>
                <div class="sidebar-item" data-view="settings" title="Settings">‚öôÔ∏è</div>
            </aside>
            <div id="left-panel-content" class="sidebar-panel">
                <!-- Explorer View -->
                <div id="view-explorer" class="view-content active">
                    <h4>Explorer</h4>
                    <div id="saved-files-list">
                        <div class="log-entry" style="font-size:11px; opacity:0.6;">No saved files yet.</div>
                    </div>
                </div>

                <!-- Cloud View -->
                <div id="view-cloud" class="view-content">
                    <h4>Cloud Workspaces</h4>
                    <div id="cloud-auth-section">
                        <div id="auth-logged-out">
                            <input type="email" id="auth-email" placeholder="Email" class="cloud-input">
                            <input type="password" id="auth-password" placeholder="Password" class="cloud-input">
                            <div style="display:flex; gap:5px; margin-top:5px;">
                                <button id="auth-login-btn" class="cloud-btn">Login</button>
                                <button id="auth-signup-btn" class="cloud-btn">Sign Up</button>
                            </div>
                        </div>
                        <div id="auth-logged-in" style="display:none;">
                            <div style="display:flex; justify-content:space-between; align-items:center;">
                                <span id="user-display" style="font-size:11px; opacity:0.8;"></span>
                                <button id="auth-logout-btn" style="background:transparent; border:none; color:#ff79c6; cursor:pointer; font-size:10px;">Logout</button>
                            </div>
                            <div id="org-display" style="font-size:12px; font-weight:bold; margin-top:5px; color:#50fa7b;"></div>
                        </div>
                    </div>
                    <hr style="border:0; border-top:1px solid #333; margin:15px 0;">
                    <div id="cloud-hierarchy-section" style="display:none;">
                        <div class="hierarchy-level"><label>Team</label><select id="team-selector" class="cloud-select"></select><button id="create-team-btn" class="mini-btn">+</button></div>
                        <div class="hierarchy-level"><label>Workspace</label><select id="workspace-selector" class="cloud-select"></select><button id="create-workspace-btn" class="mini-btn">+</button></div>
                        <div class="hierarchy-level"><label>Project</label><select id="project-selector" class="cloud-select"></select><button id="create-project-btn" class="mini-btn">+</button></div>
                        <div class="hierarchy-level" style="flex-direction:column; align-items:flex-start;">
                            <label style="width:100%;">Files</label>
                            <div id="cloud-file-list" class="cloud-list"></div>
                            <button id="create-file-btn" class="cloud-btn" style="width:100%; margin-top:5px;">+ New Cloud File</button>
                        </div>
                    </div>
                </div>

                <!-- AI Agent View -->
                <div id="view-ai-agent" class="view-content">
                    <h4>AI Agent (Gemini)</h4>
                    <div id="ai-chat-container">
                        <div id="ai-chat-history">
                            <div class="chat-msg ai">Hello! I can help you with Deluge methods or explain your code. Make sure to add your Gemini API Key in Settings.</div>
                        </div>
                        <div class="ai-input-area">
                            <textarea id="ai-question" placeholder="Ask about code or methods... (Ctrl+Enter to send)"></textarea>
                            <button id="ai-ask-btn">Ask Gemini</button>
                        </div>
                    </div>
                </div>

                <!-- Zoho APIs View -->
                <div id="view-zoho-apis" class="view-content">
                    <h4>Zoho Resources</h4>
                    <div id="zoho-resources-list" style="font-size:12px;">
                        <div style="opacity:0.6; padding:10px;">Quick reference for common methods. Use the Docs tab below for search.</div>
                        <div class="resource-section"><h5>String</h5><ul><li>length()</li><li>subString()</li><li>indexOf()</li></ul></div>
                        <div class="resource-section"><h5>List</h5><ul><li>add()</li><li>get()</li><li>size()</li></ul></div>
                        <div class="resource-section"><h5>Map</h5><ul><li>put()</li><li>get()</li><li>keys()</li></ul></div>
                    </div>
                </div>

                <!-- Snippets View -->
                <div id="view-snippets" class="view-content">
                    <h4>Deluge Snippets</h4>
                    <div class="snippets-container" style="font-size:12px;">
                        <div class="snippet-group">
                            <h5>Map Manipulation</h5>
                            <div class="snippet-btn" data-snippet="map">create map</div>
                            <div class="snippet-btn" data-snippet="put">put</div>
                            <div class="snippet-btn" data-snippet="put_all">put all keys</div>
                            <div class="snippet-btn" data-snippet="remove_key">remove key</div>
                            <div class="snippet-btn" data-snippet="clear_map">clear map</div>
                            <div class="snippet-btn" data-snippet="get">get value</div>
                            <div class="snippet-btn" data-snippet="keys">get keys</div>
                        </div>
                        <div class="snippet-group">
                            <h5>Collection (Native)</h5>
                            <div class="snippet-btn" data-snippet="collection_create">create collection</div>
                            <div class="snippet-btn" data-snippet="collection_insert">insert</div>
                            <div class="snippet-btn" data-snippet="collection_get">get</div>
                            <div class="snippet-btn" data-snippet="collection_insert_all">insertAll</div>
                            <div class="snippet-btn" data-snippet="collection_update">update</div>
                            <div class="snippet-btn" data-snippet="collection_delete">delete</div>
                            <div class="snippet-btn" data-snippet="collection_keys">keys</div>
                            <div class="snippet-btn" data-snippet="collection_values">values</div>
                            <div class="snippet-btn" data-snippet="collection_contains_key">contains key</div>
                            <div class="snippet-btn" data-snippet="collection_contains_value">contains value</div>
                            <div class="snippet-btn" data-snippet="collection_clear">clear</div>
                            <div class="snippet-btn" data-snippet="collection_sort">sort value</div>
                            <div class="snippet-btn" data-snippet="collection_is_empty">is empty</div>
                            <div class="snippet-btn" data-snippet="collection_size">size</div>
                        </div>
                        <div class="snippet-group">
                            <h5>Web Data</h5>
                            <div class="snippet-btn" data-snippet="zoho_integration">zoho integration</div>
                            <div class="snippet-btn" data-snippet="other_integration">other integration</div>
                            <div class="snippet-btn" data-snippet="get_url">get url</div>
                            <div class="snippet-btn" data-snippet="post_url">post url</div>
                            <div class="snippet-btn" data-snippet="invoke_url">invoke url</div>
                            <div class="snippet-btn" data-snippet="open_url">open url</div>
                            <div class="snippet-btn" data-snippet="invoke_api">invoke API</div>
                            <div class="snippet-btn" data-snippet="ftp">FTP/SFTP</div>
                        </div>
                        <div class="snippet-group">
                            <h5>Xml Manipulation</h5>
                            <div class="snippet-btn" data-snippet="xpath">execute XPath</div>
                        </div>
                        <div class="snippet-group">
                            <h5>Condition</h5>
                            <div class="snippet-btn" data-snippet="if">if</div>
                            <div class="snippet-btn" data-snippet="else if">else if</div>
                            <div class="snippet-btn" data-snippet="else">else</div>
                            <div class="snippet-btn" data-snippet="conditional if">conditional if</div>
                        </div>
                        <div class="snippet-group">
                            <h5>Data Access (Creator)</h5>
                            <div style="margin-bottom:10px; display:flex; flex-direction:column; gap:5px; border-bottom:1px solid #333; padding-bottom:10px;">
                                <button id="fetch-creator-forms-btn" class="mini-btn" style="width:100%; font-size:10px;">Fetch Creator Forms</button>
                                <select id="creator-form-selector" class="mini-select" style="width:100%; display:none; background:#1e1e1e; color:#ccc; border:1px solid #444; padding:2px; font-size:10px;"></select>
                            </div>
                            <div class="snippet-btn" data-snippet="insert">add record</div>
                            <div class="snippet-btn" data-snippet="fetch">fetch records</div>
                            <div class="snippet-btn" data-snippet="aggregate">aggregate records</div>
                            <div class="snippet-btn" data-snippet="update">update record</div>
                            <div class="snippet-btn" data-snippet="update_multiple">update multiple fields</div>
                            <div class="snippet-btn" data-snippet="for each">for each record</div>
                            <div class="snippet-btn" data-snippet="delete">delete records</div>
                        </div>
                        <div class="snippet-group">
                            <h5>List Manipulation</h5>
                            <div class="snippet-btn" data-snippet="list">create list</div>
                            <div class="snippet-btn" data-snippet="add">add</div>
                            <div class="snippet-btn" data-snippet="remove">remove index</div>
                            <div class="snippet-btn" data-snippet="remove_element">remove element</div>
                            <div class="snippet-btn" data-snippet="add_all">add all | remove all</div>
                            <div class="snippet-btn" data-snippet="clear">clear list</div>
                            <div class="snippet-btn" data-snippet="sort">sort</div>
                            <div class="snippet-btn" data-snippet="for_each_element">for each element</div>
                            <div class="snippet-btn" data-snippet="for_each_index">for each index</div>
                            <div class="snippet-btn" data-snippet="list_get">get element</div>
                        </div>
                        <div class="snippet-group">
                            <h5>Miscellaneous</h5>
                            <div class="snippet-btn" data-snippet="variable">set variable</div>
                            <div class="snippet-btn" data-snippet="function">call function</div>
                            <div class="snippet-btn" data-snippet="mail">send mail</div>
                            <div class="snippet-btn" data-snippet="add_comment">add comment</div>
                            <div class="snippet-btn" data-snippet="return">return</div>
                            <div class="snippet-btn" data-snippet="info">info (debug)</div>
                        </div>
                    </div>
                </div>

                <!-- Extensions View -->
                <div id="view-extensions" class="view-content">
                    <h4>Extensions</h4>
                    <div style="padding:10px;">
                        <div class="extension-item" style="display:flex; gap:10px; margin-bottom:15px; border-bottom:1px solid #333; padding-bottom:10px;">
                            <div style="background:#007acc; width:40px; height:40px; border-radius:5px; display:flex; align-items:center; justify-content:center;">L</div>
                            <div style="flex:1;">
                                <div style="font-size:13px; font-weight:bold;">Deluge Linter</div>
                                <div style="font-size:11px; opacity:0.7;">Real-time syntax & semicolon checking.</div>
                                <div style="font-size:10px; color:#50fa7b; margin-top:3px;">Enabled (Built-in)</div>
                            </div>
                        </div>
                        <div class="extension-item" style="display:flex; gap:10px; margin-bottom:15px; border-bottom:1px solid #333; padding-bottom:10px;">
                            <div style="background:#ff79c6; width:40px; height:40px; border-radius:5px; display:flex; align-items:center; justify-content:center;">A</div>
                            <div style="flex:1;">
                                <div style="font-size:13px; font-weight:bold;">AI Agent (Gemini)</div>
                                <div style="font-size:11px; opacity:0.7;">Explain code and generate snippets.</div>
                                <div style="font-size:10px; color:#50fa7b; margin-top:3px;">Enabled (Built-in)</div>
                            </div>
                        </div>
                        <div class="extension-item" style="display:flex; gap:10px; margin-bottom:15px; border-bottom:1px solid #333; padding-bottom:10px; opacity:0.5;">
                            <div style="background:#444; width:40px; height:40px; border-radius:5px; display:flex; align-items:center; justify-content:center;">F</div>
                            <div style="flex:1;">
                                <div style="font-size:13px; font-weight:bold;">Deluge Formatter</div>
                                <div style="font-size:11px; opacity:0.7;">Auto-format your Deluge code.</div>
                                <div style="font-size:10px; color:#aaa; margin-top:3px;">Coming Soon...</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Settings View -->
                <div id="view-settings" class="view-content">
                    <h4>Settings</h4>
                    <div class="setting-item">
                        <label style="font-size:12px; margin-bottom:4px;">Gemini Model:</label>
                        <select id="gemini-model" style="width:100%; background:#1e1e1e; color:#ccc; border:1px solid #444; padding:5px;">
                            <option value="gemini-2.0-flash-exp">Gemini 2.0 Flash (Latest)</option>
                            <option value="gemini-3-flash-preview">Gemini 3.0 Flash (Experimental)</option>
                            <option value="gemini-3-pro-preview">Gemini 3.0 Pro (Most Powerful)</option>
                            <option value="gemini-1.5-flash">Gemini 1.5 Flash (Fast)</option>
                            <option value="gemini-1.5-pro">Gemini 1.5 Pro (Better results)</option>
                        </select>
                    </div>
                    <div class="setting-item">
                        <label style="font-size:12px; margin-bottom:4px;">Gemini API Key:</label>
                        <input type="password" id="gemini-api-key" placeholder="AIZA...">
                        <button id="save-settings-btn" style="margin-top:10px;">Save Configuration</button>
                    </div>
                    <div class="setting-item" style="margin-top:20px;">
                        <label style="font-size:12px; margin-bottom:4px;">Editor Theme:</label>
                        <select id="theme-selector" style="width:100%; background:#1e1e1e; color:#ccc; border:1px solid #444; padding:5px;">
                            <option value="vs-dark">Dark (Default)</option>
                            <option value="dracula">Dracula</option>
                            <option value="vs-light">Light</option>
                        </select>
                    </div>
                    <div style="margin-top:30px; font-size:11px; color:#888;">
                        <strong>Shortcuts:</strong><br>
                        Ctrl+S: Save Locally<br>
                        Ctrl+Shift+S: Sync + Save Zoho<br>
                        Ctrl+Shift+Enter: Sync + Execute<br>
                        Ctrl+Shift+P: Pull from Zoho<br>
                        Ctrl+Shift+E: Open/Focus IDE
                    </div>
                </div>
            </div>
<div id="left-resizer" class="resizer"></div>
            <div id="editor-container"></div>

            <div id="right-sidebar-resizer" class="resizer"></div>
            <aside id="right-sidebar">
                <div class="right-sidebar-header">
                    <div class="header-row">
                        <span class="header-title">Interface Manager</span>
                    </div>
                    <div class="header-row icons-row">
                        <button id="toggle-right-sidebar" class="sidebar-btn" title="Toggle Sidebar">
                            <svg viewBox="0 0 24 24" width="16" height="16"><path fill="currentColor" d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/></svg>
                        </button>
                        <button id="add-interface-btn" class="sidebar-btn" title="Add Interface Mapping">+</button>
                    </div>
                    <div class="search-container">
                        <input type="text" id="interface-search" placeholder="Search keys...">
                    </div>
                </div>
                <div id="interface-mappings-list">
                    <!-- Mappings will appear here -->
                </div>
                <div id="interface-tree-view">
                    <div style="font-size:11px; opacity:0.5; text-align:center; margin-top:20px;">
                        Select a mapping to explore its structure
                    </div>
                </div>
            </aside>
        </main>
        <div id="bottom-resizer" class="resizer horizontal"></div>
        <footer id="bottom-panel">
            <div class="panel-header">
                <div class="tab active" data-target="console-output">Console</div>
                <div class="tab" data-target="problems-output">Problems</div>
                <div class="tab" data-target="docs-output">Docs</div>
                <div class="tab" data-target="api-explorer">API Explorer</div>
                <div class="panel-actions">
                    <button id="clear-console">Clear</button>
                </div>
            </div>
            <div id="panel-body">
                <div id="console-output" class="panel-content active">
                    <div class="log-entry system">Welcome to Deluge IDE.</div>
                </div>
                <div id="problems-output" class="panel-content">
                    <div id="problems-list">
                        <div class="log-entry">No problems detected.</div>
                    </div>
                </div>
                <div id="docs-output" class="panel-content">
                    <div class="docs-search-container"><input type="text" id="docs-search" placeholder="Search methods..."></div>
                    <div id="docs-resources-list">
                         <div class="resource-section"><h5>String Methods</h5><ul><li>length()</li><li>subString(start, end)</li><li>indexOf(str)</li><li>startsWith(prefix)</li><li>toLowerCase()</li><li>toUpperCase()</li><li>trim()</li><li>toList(delim)</li></ul></div><div class="resource-section"><h5>List Methods</h5><ul><li>add(val)</li><li>addAll(list)</li><li>get(index)</li><li>size()</li><li>isEmpty()</li><li>remove(index)</li><li>contains(val)</li></ul></div><div class="resource-section"><h5>Map Methods</h5><ul><li>put(key, val)</li><li>get(key)</li><li>getJSON(key)</li><li>keys()</li><li>remove(key)</li><li>clear()</li></ul></div>
                    </div>
                </div>
                <div id="api-explorer" class="panel-content">
                    <div class="api-explorer-header">
                        <select id="api-product-selector" class="api-select">
                            <option value="crm">Zoho CRM</option>
                            <option value="books">Zoho Books</option>
                            <option value="creator">Zoho Creator</option>
                            <option value="recruit">Zoho Recruit</option>
                        </select>
                        <input type="text" id="api-search" placeholder="Search APIs (e.g. get records)..." class="api-search-input">
                    </div>
                    <div id="api-results-list" class="api-list">
                        <!-- API references will be populated here -->
                    </div>
                </div>
            </div>
        </footer>
    <style>
        .api-explorer-header { display: flex; gap: 10px; padding: 10px; background: #252526; border-bottom: 1px solid #333; position: sticky; top: 0; z-index: 10; }
        .api-select { background: #3c3c3c; color: white; border: 1px solid #555; padding: 4px; font-size: 12px; }
        .api-search-input { flex: 1; background: #3c3c3c; color: white; border: 1px solid #555; padding: 4px 8px; font-size: 12px; }
        .api-list { padding: 10px; }
        .api-item { padding: 8px; border-bottom: 1px solid #333; cursor: pointer; transition: background 0.2s; }
        .api-item:hover { background: #2a2d2e; }
        .api-item-title { font-weight: bold; font-size: 12px; color: #50fa7b; display: block; }
        .api-item-desc { font-size: 11px; color: #aaa; margin-top: 2px; display: block; }
        .api-item-tag { font-size: 10px; background: #44475a; color: #f8f8f2; padding: 1px 4px; border-radius: 3px; margin-right: 5px; text-transform: uppercase; }

        #problems-list .problem-item { display: flex; align-items: flex-start; gap: 8px; padding: 4px 10px; font-size: 12px; cursor: pointer; border-bottom: 1px solid #333; }
        #problems-list .problem-item:hover { background: #2a2d2e; }
        #problems-list .problem-severity-error { color: #ff5555; }
        #problems-list .problem-severity-warning { color: #ffb86c; }
        #problems-list .problem-loc { color: #888; font-size: 11px; margin-left: auto; }
    </style>

        <div id="status-bar">
            <div class="status-left">
                <span id="sync-status">Ready</span>
                <span id="cursor-pos">Ln 1, Col 1</span>
            </div>
            <div class="status-right">
                <span>Deluge</span>
            </div>
        </div>
    </div>

    <!-- JSON Input Modal -->
    <div id="interface-modal" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.8); z-index:9999; align-items:center; justify-content:center;">
        <div style="background:#252526; padding:20px; border-radius:5px; width:80%; max-width:600px; border:1px solid #444;">
            <h3 id="modal-title" style="margin-top:0;">Convert JSON to Deluge Map</h3>
            <div id="modal-var-container" style="margin-bottom:10px;">
                <label style="font-size:12px; color:#aaa;">Variable Name:</label>
                <input type="text" id="interface-var-name" value="payload" style="width:100%; background:#1e1e1e; color:#ccc; border:1px solid #444; padding:5px; margin-top:4px;">
            </div>
            <p style="font-size:12px; color:#aaa;">Paste your JSON payload below:</p>
            <textarea id="interface-input" style="width:100%; height:200px; background:#1e1e1e; color:#ccc; border:1px solid #444; padding:10px; font-family:monospace;"></textarea>
            <div style="margin-top:15px; display:flex; justify-content:flex-end; gap:10px;">
                <button id="modal-cancel" style="background:#444; color:white; border:none; padding:8px 15px; cursor:pointer;">Cancel</button>
                <button id="modal-convert" style="background:#007acc; color:white; border:none; padding:8px 15px; cursor:pointer;">Convert & Insert</button>
                <button id="modal-map-only" style="background:#28a745; color:white; border:none; padding:8px 15px; cursor:pointer; display:none;">Save Mapping</button>
            </div>
        </div>
    </div>

    <script src="assets/monaco-editor/min/vs/loader.js"></script>
    <script src="loader-init.js"></script>
</body>
</html>
